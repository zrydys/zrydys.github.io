<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Leaflet ELT Demo</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <style>
        #map {
            height: 100vh;
            width: 100%;
        }
	img {height: 12px } 
        .control {
            margin: 10px;
        }
    </style>
</head>
<body>
¬†¬†¬†ZryDys'¬†¬† üîç<a href="/?pg=index.html" class="text-light me-3">Technology Services</a> |
<img src="/zrydysML.png"><a href="/details.html" class="text-light me-3">Who</a> |  
<img src="/thumb/dsci-byUrl.jpg"><a href="/visual-plotly.html" class="text-light me-3">Visual BI</a> |  
<h2> Electronic Light Table features - free Demo </h2>

This is a demo of using open-source to explore ELT GIS imagery from any modern web browser:

<div id="map"></div>

<!-- Slider to control opacity -->
<div class="control">
    <label for="opacity-slider">Layer Opacity: </label>
    <input type="range" id="opacity-slider" min="0" max="1" step="0.01" value="1" />
</div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
    // Initialize the map object
    var map = L.map('map',
      {  minZoom: 1,   // limit min zoom to 1
	  }
    ).setView([51.505, -50.09], 4); // Centered on the world with zoom level 2  ==>4 for layer

    // Add the ESRI satellite imagery layer as the base layer
    var satelliteLayer = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
        attribution: '&copy; <a href="https://www.esri.com/">ESRI</a>',
        maxZoom: 16,
        minZoom: 2
    }).addTo(map);

    // Add OpenStreetMap as an alternative base layer
    var osmLayer = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
        maxZoom: 19,
        minZoom: 2
    });
//OSM changed legal international borders so need USGS or UN or NASA maps instead

       // var map = L.map("map", { minZoom: 1.7, maxZoom: 7, maxBounds: L.latLngBounds(L.latLng(-90, -180), L.latLng(90, 180) ) , }) .setView([0, 2], 3);

  var NASAGIBS_ViirsEarthAtNight2012 = L.tileLayer('https://map1.vis.earthdata.nasa.gov/wmts-webmerc/VIIRS_CityLights_2012/default/{time}/{tilematrixset}{maxZoom}/{z}/{y}/{x}.{format}', {
	attribution: 'by GIBS, operated by the NASA/GSFC/Earth Science Data and Information System (<a href="https://earthdata.nasa.gov"  target="_blank">ESDIS</a>);',
	bounds: [[-85.0511287776, -179.999999975], [85.0511287776, 179.999999975]],
	minZoom: 1,
	maxZoom: 8,
	format: 'jpg',
	time: '',
	tilematrixset: 'GoogleMapsCompatible_Level'
})

 // L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png',  // wrong map non-iso osm
  var USGS_USImageryTopo = L.tileLayer('https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryTopo/MapServer/tile/{z}/{y}/{x}', {
	maxZoom: 20,
	attribution: 'Tiles courtesy of the <a href="https://usgs.gov/"  target="_blank">U.S. Geological Survey</a>'
}); // add to base INSTEAD OF USGS .addTo(map);

   var unbase = L.tileLayer(
   "https://geoservices.un.org/arcgis/rest/services/ClearMap_WebTopo/MapServer/tile/{z}/{y}/{x}", {
   maxClusterRadius: 12,
   zoom: 2,
   attribution:"\u003Ca href=\u0022https:\/\/geoportal.un.org\/arcgis\/home\/item.html?id=541557fd0d4d42efb24449be614e6887\u0022 target=\u0022blank\u0022 style=\u0022text-decoration: none;\u0022\u003EProduced by: UN Geospatial\u003C\/a\u003E"
}) ;


    // Custom ZryDys tile layer for comparison 
    var customTileLayer = L.tileLayer('https://zrydys.github.io/tiles/{z}-{x}-{y}.png', {
        attribution: 'Custom ELT MAP Tiles from zrydys.github.io',
        maxZoom: 10,
        minZoom: 2,
        tileSize: 256,
        subdomains: 'abc',
        opacity: 0.7,
        noWrap: true
    });

    // Custom ZryDys FLAGS tile layer for comparison 
    var flagsTileLayer = L.tileLayer('https://infchg.github.io/GeoInt/wms/tflag/{z}-{x}-{y}.png', {
        attribution: 'Custom ELT FLAG Tiles from infchg.github.io',
        maxZoom: 10,
        minZoom: 2,
        tileSize: 256,
  maxNativeZoom: 4,      //  PNG reales est√°n solo en Z4 x ahora
        subdomains: 'abc',
        opacity: 0.7,
        noWrap: true
    });

// https://thredds.socib.es/thredds/wms/  gives OpenDap & WMS  https://thredds.ucar.edu/. You are welcome to browse and access these meteorological datasets. If you need regular access to large amounts of data, please contact support-idd@unidata.ucar.edu.
var NOcj1 = L.tileLayer( "https://thredds.socib.es/thredds/wms/observational/hf_radar/hf_radar_ibiza-scb_codarssproc001_aggregation/dep0001_hf-radar-ibiza_scb-codarssproc001_L1_agg.nc",
   { layers: 'sea_water_velocity',
    format: 'image/png',
    transparent: true,
    attribution: 'SOCIB HF RADAR | sea_water_velocity'
  });
//.addTo(map)
var Ncj1 = L.tileLayer.wms('https://thredds.ucar.edu/thredds/wms/nexrad/nexrad3.nc', { //cors e issues 
            layers: 'reflectivity',
            format: 'image/png',
            transparent: true,
            attribution: "NEXRAD Data by UCAR"
        });
const azFaults = L.tileLayer('https://tiles.arcgis.com/tiles/Ezk9fcjSUkeadg6u/arcgis/rest/services/ContactsAndFaultsFixedDMU/MapServer/tile/{z}/{y}/{x}', {
	maxZoom: 12,  //correcto cors AZ Faults / Fallas Arizona
	attribution: 'azgs.az.gov + &copy; <a href="https://www.esri.com/en-us/home">Esri</a>'
});
const cj1 = L.tileLayer('https://tiles.arcgis.com/tiles/Ezk9fcjSUkeadg6u/arcgis/rest/services/ContactsAndFaultsFixedDMU/MapServer/tile/{z}/{y}/{x}', {
	maxZoom: 12,  //correcto cors AZ Faults / Fallas Arizona
	attribution: '&copy; <a href="https://www.esri.com/en-us/home">Esri</a>'
});

//no http://data.azgs.az.gov/arizona/wms   se at https://uagis.maps.arcgis.com/apps/webappviewer/index.html?id=98729f76e4644f1093d1c2cd6dabb584  & https://geomapaz.azgs.arizona.edu/
var NOcj2 = L.tileLayer( 'https://data.azgs.az.gov/arizona/wms',   {  
layers: 'azgs:mapunitpolys',
transparent: true,
format: 'image/png'
}) ;

        // Define the ArcGIS tile layer
const  cj2 = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
	maxZoom: 12,
	attribution: '&copy; <a href="https://www.esri.com/en-us/home">Esri</a>'
});

 
var radar = L.tileLayer.wms( "https://mesonet.agron.iastate.edu/cgi-bin/wms/nexrad/n0r.cgi", {
  layers: "nexrad-n0r-900913",
  format: "image/png",
  transparent: true
} );

var nasaTerra = L.tileLayer.wms('https://gibs.earthdata.nasa.gov/wms/epsg4326/best/wms.cgi', {
            layers: 'MODIS_Terra_CorrectedReflectance_TrueColor',
            format: 'image/png',
            transparent: true,
            opacity: .3,
            attribution: 'NASA GIBS'
        });

// ="https://tiles.arcgis.com/tiles/Ezk9fcjSUkeadg6u/arcgis/rest/services/ContactsAndFaultsFixedDMU/MapServer/tile/7/50/22" 


//https://geo.weather.gc.ca/geomet?service=WMS&layers=RADAR_1KM_RRAI&version=1.3.0&REQUEST=getcapabilities
var cj3 = L.tileLayer( 'https://geo.weather.gc.ca/geomet?service=WMS', {     layers: 'RADAR_1KM_RRAI' });  //bi
//https://wms.mapama.gob.es/sig/costas/SP/wms.aspx?request=getcapabilities&service=WMS&version=1.3.0  BIEN pero  in a cross-site context and its ‚ÄúSameSite‚Äù is ‚ÄúLax‚Äù or ‚ÄúStrict‚Äù.
var cj4 = L.tileLayer( 'https://wms.mapama.gob.es/sig/costas/SP/wms.aspx?service=WMS&' , {   layers: 'AM.CoastalZoneManagementArea'  }); //kCORS curl "https://wms.mapama.gob.es/sig/costas/SP/wms.aspx?service=WMS&request=GetCapabilities&version=1.3.0"
var cj5 = L.tileLayer( 'http://ovc.catastro.meh.es/Cartografia/WMS/ServidorWMS.aspx?' , {    layers: 'Spain_Catastro' }); // request=GetCapabilities&service=WMS 
var cj6 = L.tileLayer( 'http://www.callejerodeandalucia.es/servicios/cdau/wms?' , {   layers: 'Andalucia_CDAUBase'  });
//var cj6 = L.tileLayer( ' ' , {   layers: ''  });
//https://view.eumetsat.int/geoserver/wfs  layer named copernicus:sentinel3a_slstr_level2_frp)
var cj7 = L.tileLayer( 'https://view.eumetsat.int/geoserver/wfs' , {   layers: 'copernicus:sentinel3a_slstr_level2_frp'  });

    // Add a Layer Control to switch between base layers
    var baseLayers = {
        "Satellite Imagery": satelliteLayer,
           "USGS Topo Imag": USGS_USImageryTopo, // dice WS-disp  ---> best2
           "United Nations": unbase,
           "NASA at Night": NASAGIBS_ViirsEarthAtNight2012 , //  ---> cool
//OSM changed legal international borders so need USGS or UN or NASA maps instead "OpenStreetMap": osmLayer
    };

    var overlayLayers = {
        "ELT Custom labels": customTileLayer,
        "ELT Custom flags": flagsTileLayer,
        "Nasa Terra color": nasaTerra,
        "Arizona's Faults": azFaults,
        "US Meteo Radar": radar,
        " 1 ": cj1,
         " 2 ": cj2,
        " 3 ": cj3,
        " 4 ": cj4,
        " 5 ": cj5,
        " 6 ": cj6,
         " 7 ": cj7,
   };

//unbase.addTo(map);
//  L.control.layers(null,overlays).addTo(map);
    L.control.layers(baseLayers, overlayLayers).addTo(map);

    // Set up opacity control slider for layers
    var opacitySlider = document.getElementById('opacity-slider');
    
    // Update opacity of all layers based on slider value
    opacitySlider.addEventListener('input', function() {
        var opacity = parseFloat(opacitySlider.value);
        satelliteLayer.setOpacity(opacity);
        nasaTerra.setOpacity(opacity);
        customTileLayer.setOpacity(opacity);
        flagsTileLayer.setOpacity(opacity);
    });

    // Add initial custom tile layer to map (but it's not visible by default)
    flagsTileLayer.addTo(map);
    nasaTerra.addTo(map);
    azFaults.addTo(map);  
    radar.addTo(map);
</script>

 <iframe id="contentFrame" src="" style="h2{color:green;};  width: 100%; h2 {color: green} #h2-menu { position: fixed; top: 10px; right: 10px; background: rgba(0,0,0,0.7); color: white; padding: 10px; border-radius: 6px; font-family: sans-serif; max-width: 200px; z-index: 999; } #h2-menu a { display: block; color: #00f7ff; text-decoration: none; margin-bottom: 5px; font-size: 14px; } #h2-menu a:hover { text-decoration: underline; } /* Style for h2 elements */ h2 { color: #005577; font-family: 'Georgia', serif; font-weight: bold; border-left: 4px solid #00f7ff; padding-left: 10px; margin-top: 40px; }; height: 100vh; " allowtransparency="true" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>  
¬† <script>  
¬†¬†¬† const params = new URLSearchParams(window.location.search);  
¬†¬†¬† const page = params.get("pg") || "/tiles/";  
¬†¬†¬† document.getElementById("contentFrame").src = page;  
¬† </script>  

<hr/>
    <div>+ OpenCV.js Image Processing <img  id="imageElement" src="zrydysML.png">

    <canvas id="canvasOutput"></canvas>

        <button onclick="toBlackWhite()">Click to Black & White</button>
        <button onclick="toPurple()">Click to Change color</button>
    </div>
<script async src="https://docs.opencv.org/4.x/opencv.js" type="text/javascript"> cc-by-sa CJ2026 OpenCV</script>
<script>
  async function toBlackWhite() {  //main
    await cv.ready;
    let img = cv.imread('imageElement');
    let dst = new cv.Mat();
    cv.cvtColor(img, dst, cv.COLOR_RGBA2GRAY);
    cv.imshow('canvasOutput', dst);
    img.delete(); dst.delete();
  }
  
  async function toPurple() {
	await cv.ready;
	let img = cv.imread('imageElement');
	let dst = new cv.Mat();
	// Convert to purple: increase red and blue channels
	let channels = new cv.MatVector();
	cv.split(img, channels);
	let red = channels.get(0);
	let green = channels.get(1);
	let blue = channels.get(2);
	cv.add(red, new cv.Mat(red.rows, red.cols, cv.CV_8U, new cv.Scalar(0)), red);
	cv.add(blue, new cv.Mat(blue.rows, blue.cols, cv.CV_8U, new cv.Scalar(0)), blue);
	cv.merge(channels, dst);
	cv.imshow('canvasOutput', dst);	
	cv.imshow('canvasOutput', green);

//	img.delete(); dst.delete();
	red.delete(); green.delete(); blue.delete(); channels.delete();
}
</script>
</body>

our document grading: 
<div class="alert alert-success" role="alert">
    success!
</div>

<div class="alert alert-warning" role="alert">
    warning!
</div>

<div class="alert alert-info" role="alert">
    info!
</div>

<div class="alert alert-danger" role="alert">
    danger!
</div>
</html>
